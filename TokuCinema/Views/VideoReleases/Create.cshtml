@model TokuCinema.Models.VideoRelease

@{
    ViewBag.Title = "Create";
    TokuCinema.Models.TokuCinema_DataEntities db = new TokuCinema.Models.TokuCinema_DataEntities();
}

<h2>Create</h2>

@using (Html.BeginForm()) 
{
    @Html.AntiForgeryToken()
    
    <div class="form-horizontal">
        <h4>Video Release</h4>
        <p>* Indicates required field</p>
        <hr />
        @Html.ValidationSummary(true, "", new { @class = "text-danger" })

        <script src="~/Scripts/ChildFactory.js"></script>

        <script>
            /* Instantiate Version Factory

            *Currently a child factory relies on the below markup:
            - input element to hold the number of children                          <input type="hidden" name="numberOfVersions" id="numberOfVersions">
            - div element to hold the partial view returned by the Ajax request:    <div class="col-md-4" id="VideoVersionId"></div>
            - div element to append versions:                                       <div class="form-group" id="selectedVersions"></div>

            *Will be optional soon
            - a control to filter results from Ajax request:                        Html.DropDownList("videoMediaId", new SelectList(db.VideoMedias.OrderBy(v => v.ReleaseDate), 
                                                                                    "VideoMediaId", "Medium.MediaOfficialTitle"), "", htmlAttributes: new { class = "form-control", 
                                                                                    onchange = "versionFactory.getChildren()" "getVideoVersions()" })

            * Relies on a partial view containing desired results to be retrieved through an Ajax call
            */
            var versionFactory = new childFactory("version", "GetVersions", "VideoReleases", "numberOfVersions", "VideoVersionId", "VideoVersionTypeId", "selectedVersions", "videoMediaId");

        </script>
        
        @*Original Script is available at the bottom of the "ChildFactory.js" file*@        

        <input type="hidden" name="numberOfVersions" id="numberOfVersions">
        
        <div class="form-group" id="versionSelector">
            @Html.Label("VideoMediaId", "Video Media", htmlAttributes: new { @class = "control-label col-md-2 required-field" })
            <div class="col-md-4">
                @Html.DropDownList("videoMediaId", new SelectList(db.VideoMedias.OrderBy(v => v.ReleaseDate), "VideoMediaId", "Medium.MediaOfficialTitle"), "", htmlAttributes: new { @class = "form-control", @onchange = "versionFactory.getChildren()" @*"getVideoVersions()"*@ })
            </div>
            @Html.Label("VideoVersionTypeId", "Video Version", htmlAttributes: new { @class = "control-label col-md-2 required-field" })
            <div class="col-md-4" id="VideoVersionId">
            </div>
        </div>

        <div class="form-group" id="selectedVersions"></div>

        <div class="form-group">
            @Html.LabelFor(model => model.DistributorId, "DistributorId", htmlAttributes: new { @class = "control-label col-md-2 required-field" })
            <div class="col-md-10">
                @Html.DropDownList("DistributorId", null, htmlAttributes: new { @class = "form-control" })
                @Html.ValidationMessageFor(model => model.DistributorId, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.PackagingId, "PackagingId", htmlAttributes: new { @class = "control-label col-md-2 required-field" })
            <div class="col-md-10">
                @Html.DropDownList("PackagingId", null, htmlAttributes: new { @class = "form-control" })
                @Html.ValidationMessageFor(model => model.PackagingId, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.CatalogCode, htmlAttributes: new { @class = "control-label col-md-2 required-field" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.CatalogCode, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.CatalogCode, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.UPC, htmlAttributes: new { @class = "control-label col-md-2 required-field" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.UPC, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.UPC, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.ReleaseDate, htmlAttributes: new { @class = "control-label col-md-2 required-field" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.ReleaseDate, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.ReleaseDate, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            @Html.LabelFor(model => model.DiscCount, htmlAttributes: new { @class = "control-label col-md-2 required-field" })
            <div class="col-md-10">
                @Html.EditorFor(model => model.DiscCount, new { htmlAttributes = new { @class = "form-control" } })
                @Html.ValidationMessageFor(model => model.DiscCount, "", new { @class = "text-danger" })
            </div>
        </div>

        <div class="form-group">
            <div class="col-md-offset-2 col-md-10">
                <input type="submit" value="Create" class="btn btn-default" />
            </div>
        </div>
    </div>
}

<div>
    @Html.ActionLink("Back to List", "Index")
</div>

@section Scripts {
    @Scripts.Render("~/bundles/jqueryval")
}
